<style>.overstay-card {
  background: #fff5f5;        /* light red */
  border: 1px solid #f24b4b;  /* soft red border */
}

.overstay-card .status-badge {
  background-color: #dc2626 !important;
}

.overstay-card .text-muted {
  color: #7f1d1d !important;
}
</style>
<a href="/mobile/parcel/<%= parcel.customId %>" style="text-decoration: none; color: black;">
  <div
  class="card mb-3 parcel-card shadow-sm
    <%= parcel.status === 'overstay' ? 'overstay-card' : '' %>"
  data-status="<%= parcel.status %>"
  style="border-radius: 12px;"
>

    <div class="card-body p-3">
      <div class="d-flex justify-content-between align-items-start">
        <div>
          <p class="fw-semibold mb-1 fs-6 d-flex align-items-center gap-2">
  <% if (parcel.status === 'overstay') { %>
    <span class="text-danger">âš ï¸</span>
  <% } %>
  Parcel ID : <%= parcel.customId %> %>
</p>

          <p class="text-muted mb-2" style="font-size: 0.9rem;">
            <%= parcel.terminal_store
                  ? "Stored using locker terminal"
                  : (parcel.description || " ") %>
          </p>
        </div>
        <span class="badge status-badge <%= parcel.status === 'picked'
              ? 'bg-success'
              : parcel.status === 'awaiting_drop'
              ? 'bg-warning'
              : parcel.status === 'awaiting_pick'
              ? 'bg-danger'
              : 'bg-danger' %> px-3 py-1">
          <%= parcel.status.charAt(0).toUpperCase() + parcel.status.slice(1).replace(/_/g, " ") %>
        </span>
      </div>

      <p class="mb-2" style="font-size: 0.9rem;">
        ğŸ›… <span class="me-2"><%= parcel.type %></span>
        â€¢ <%= parcel.size %>
        â€¢ â‚¹<%= parseFloat(parcel.cost).toFixed(0) %>
      </p>

      <p class="mb-1" style="font-size: 0.9rem;">
        Locker ID: <strong><%= parcel.lockerId || 'N/A' %></strong> |
        Compartment: <strong><%= parcel.UsercompartmentId || 'N/A' %></strong>
      </p>
<% if (parcel.status === 'overstay') { %>
  <p class="mb-1 text-danger fw-semibold" style="font-size: 0.85rem;">
    âš ï¸ Parcel has overstayed. Action required.
  </p>
<% } %>

      <% 
        // Format expiry date nicely in IST with weekday
        const expiryDate = new Date(parcel.expiresAt);
        const formattedExpiry = expiryDate.toLocaleString("en-IN", {
          timeZone: "Asia/Kolkata",
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
          hour: "2-digit",
          minute: "2-digit"
        });
      %>

      
<% if (parcel.status === 'awaiting_drop') { %>
  <p class="mb-1 text-muted" style="font-size: 0.85rem;">
    Reserved for : <b><%= parcel.duration + " Hours"%></b>
  </p>
<% } else { %>
  <p class="mb-1 text-muted" style="font-size: 0.85rem;">
    Stored until: <%= formattedExpiry %>
  </p>
<% } %>


 



      <p class="mb-0" style="font-size: 0.9rem;">
        Access Code: <strong><%= parcel.accessCode %></strong>
      </p>

      <div class="text-end mt-3 d-flex justify-content-end gap-2">
        <% if (parcel.status === 'awaiting_pick') { %>
  <a href="/mobile/parcel/<%= parcel.customId %>/desk-delivery" 
     class="btn btn-sm btn-outline-dark"
     style="border-radius: 8px; padding: 0.4rem 1rem;">
    ğŸ§‘â€ğŸ’¼ Desk Delivery
  </a>
<% } %>

  <a href="/mobile/parcel/<%= parcel.customId %>" 
     class="btn btn-sm btn-outline-primary"
     style="border-radius: 8px; padding: 0.4rem 1rem;">
    View Details
  </a>

  <% if   (parcel.status === 'awaiting_pick' &&
  (new Date(parcel.expiresAt) < new Date())) { %>
    <a href="/parcel/<%= parcel.customId %>/extend"
       class="btn btn-sm btn-outline-warning"
       style="border-radius: 8px; padding: 0.4rem 1rem;">
      â± Extend
    </a>
  <% } %>

  <% if (parcel.status === 'awaiting_drop' || parcel.status === 'awaiting_pick') { %>
    <a href="/mobile/incoming/<%= parcel.customId %>/qr" 
       class="btn btn-sm btn-outline-success"
       style="border-radius: 8px; padding: 0.4rem 1rem;">
      QR Code
    </a>
  <% } %>

  <% if (parcel.status === 'awaiting_payment') { %>
    <form action="/mobile/parcel/del/<%= parcel._id %>?_method=DELETE" 
          method="POST"
          onsubmit="return confirm('Are you sure you want to delete this parcel?');">
      <button type="submit" 
              class="btn btn-sm btn-outline-danger"
              style="border-radius: 8px; padding: 0.4rem 1rem;">
        ğŸ—‘ï¸ Delete
      </button>
    </form>
  <% } %>

</div>

    </div>
  </div>
</a>
